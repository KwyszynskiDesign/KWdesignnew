<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portfolio projektów | KWdesignnew</title>

  <!-- Fonts + style (ścieżki względne) -->
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="assets/css/style.css" />
  <link rel="stylesheet" href="assets/css/portfolio.css" />
</head>
<body class="portfolio-page">

  <!-- Header -->
 <header class="header">
  <div class="container header-inner">
    <a href="https://kwyszynskidesign.github.io/KWdesignnew/" class="logo">KW</a>
    <nav class="nav">
      <ul class="nav-list">
        <li><a href="https://kwyszynskidesign.github.io/KWdesignnew/">Start</a></li>
        <li><a href="index.html#why" class="smooth">Dlaczego ja</a></li>
        <li><a href="index.html#packages" class="smooth">Pakiety</a></li>
        <li><a href="index.html#contact" class="smooth">Kontakt</a></li>
      </ul>
      <button class="hamburger" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </nav>
  </div>
</header>

  <!-- Hero -->
  <section class="hero-section">
    <div class="container hero-content">
      <p class="hero-eyebrow">Moje realizacje</p>
      <h1 class="hero-title">Portfolio projektów</h1>
      <p class="hero-subtitle">Wybrane projekty: branding, strony WWW, automatyzacje.</p>
    </div>

    <!-- Karuzela skrótów projektów -->
    <div class="carousel-outer" aria-label="Lista projektów">
      <button class="carousel-nav prev" aria-label="Poprzednie">&lsaquo;</button>

     <div class="carousel-track" tabindex="0">
  <!-- ID = slug, data-project = plik w /projects -->
  <div id="voucher-magdy" class="carousel-item" data-project="voucher-salon-magdy.php">
    <div class="ci-thumb">
      <img src="assets/images/Voucher Fryzjer_druk_KW-1.png"
           alt="Voucher – Salon u Magdy" loading="lazy" decoding="async" />
    </div>
    <h3>Voucher – Salon u Magdy</h3>
  </div>

  <div id="strona-karoma" class="carousel-item" data-project="strona-karoma.html">
    <div class="ci-thumb">
      <img src="assets/images/Karoma_NewLogo.png"
           alt="Strona – Karoma" loading="lazy" decoding="async" />
    </div>
    <h3>Strona – Karoma</h3>
  </div>

  <div id="power-of-mind" class="carousel-item" data-project="power-of-mind.html">
    <div class="ci-thumb">
      <img src="assets/images/do SEO 1200x630.png"
           alt="Pakiet – Power of Mind" loading="lazy" decoding="async" />
    </div>
    <h3>Pakiet – Power of Mind</h3>
  </div>

  <div id="logo-marka-d" class="carousel-item" data-project="logo-marka-d.html">
    <div class="ci-thumb">
      <img src="assets/images/automation.png"
           alt="Logo – Marka D" loading="lazy" decoding="async" />
    </div>
    <h3>Logo – Marka D</h3>
  </div>

  <div id="strona-marka-e" class="carousel-item" data-project="strona-marka-e.html">
    <div class="ci-thumb">
      <img src="assets/images/hero.png"
           alt="Strona – Marka E" loading="lazy" decoding="async" />
    </div>
    <h3>Strona – Marka E</h3>
  </div>

  <div id="marka-f" class="carousel-item" data-project="marka-f.html">
    <div class="ci-thumb">
      <img src="assets/images/branding.png"
           alt="Pakiet – Marka F" loading="lazy" decoding="async" />
    </div>
    <h3>Pakiet – Marka F</h3>
  </div>
</div>


      <button class="carousel-nav next" aria-label="Następne">&rsaquo;</button>
    </div>
  </section>

  <!-- Viewer (tutaj ładujemy treść projektu) -->
  <section id="project-viewer" class="project-viewer hidden" aria-live="polite" aria-busy="false"></section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container footer-inner">
      <div class="footer-info">
        <p>&copy; <span id="year"></span> KWdesignnew. Wszelkie prawa zastrzeżone.</p>
      </div>
    </div>
  </footer>

  <!-- JS -->
  <script>
    // Rok w stopce
    document.getElementById('year').textContent = new Date().getFullYear();

    // Hamburger (opcjonalnie, jeśli używasz mobilnego menu z .nav-list)
    (function(){
      const burger = document.querySelector('.hamburger');
      const navList = document.querySelector('.nav-list');
      if(burger && navList){
        burger.addEventListener('click', () => navList.classList.toggle('open'));
      }
    })();

    // ---- Karuzela i ładowanie projektów ----
    const track = document.querySelector('.carousel-track');
    const prevBtn = document.querySelector('.carousel-nav.prev');
    const nextBtn = document.querySelector('.carousel-nav.next');
    const projectViewer = document.getElementById('project-viewer');

    function scrollToActive(item) {
      const trackRect = track.getBoundingClientRect();
      const itemRect = item.getBoundingClientRect();
      const left = track.scrollLeft + (itemRect.left - trackRect.left) - (trackRect.width - itemRect.width) / 2;
      track.scrollTo({ left, behavior: 'smooth' });
    }

    prevBtn.addEventListener('click', () => {
      track.scrollBy({ left: -track.offsetWidth * 0.6, behavior: 'smooth' });
    });
    nextBtn.addEventListener('click', () => {
      track.scrollBy({ left: track.offsetWidth * 0.6, behavior: 'smooth' });
    });

    // Klik w miniaturę projektu
    track.addEventListener('click', async (e) => {
      const item = e.target.closest('.carousel-item[data-project]');
      if (!item) return;

      // Aktywacja wizualna
      track.querySelectorAll('.carousel-item.active').forEach(el => el.classList.remove('active'));
      item.classList.add('active');
      scrollToActive(item);

      // Wczytaj treść projektu
      const file = item.getAttribute('data-project');
      await openProject(file);
      // Dopisz hash do URL (deep-link)
      history.replaceState(null, '', '#' + item.id);
    });

    async function openProject(file){
      setBusy(true);
      try {
        const html = await loadProject(file);
        renderProject(html);
      } catch (err) {
        renderError('Nie udało się wczytać projektu.');
        console.error(err);
      } finally {
        setBusy(false);
      }
    }

    // Loader projektów: próbuje z /projects (obok portfolio.html)
    async function loadProject(file) {
      const url = 'projects/' + file;
      const res = await fetch(url, { cache: 'no-store' });
      if (!res.ok) throw new Error('HTTP ' + res.status);
      return res.text();
    }

    function renderProject(html){
      projectViewer.innerHTML = '';
      const closeBtn = document.createElement('button');
      closeBtn.className = 'close-button';
      closeBtn.type = 'button';
      closeBtn.textContent = 'Zamknij';
      closeBtn.addEventListener('click', () => {
        projectViewer.classList.add('hidden');
        track.querySelectorAll('.carousel-item.active').forEach(el => el.classList.remove('active'));
        // reset hash
        history.replaceState(null, '', location.pathname);
      });

      const content = document.createElement('div');
      content.className = 'project-content';
      content.innerHTML = html;

      projectViewer.appendChild(closeBtn);
      projectViewer.appendChild(content);
      projectViewer.classList.remove('hidden');
      projectViewer.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function renderError(msg){
      projectViewer.innerHTML = '<div class="error-msg">'+ msg +'</div>';
      projectViewer.classList.remove('hidden');
    }

    function setBusy(state){
      projectViewer.setAttribute('aria-busy', state ? 'true' : 'false');
    }

    // Touch swipe (mobile)
    let startX = null, scrollStart = 0;
    track.addEventListener('touchstart', e => {
      startX = e.touches[0].clientX;
      scrollStart = track.scrollLeft;
    }, { passive: true });
    track.addEventListener('touchmove', e => {
      if (startX === null) return;
      const dx = e.touches[0].clientX - startX;
      track.scrollLeft = scrollStart - dx;
    }, { passive: true });
    track.addEventListener('touchend', () => { startX = null; });

    // Klawisze
    track.addEventListener('keydown', e => {
      if (e.key === 'ArrowLeft') prevBtn.click();
      if (e.key === 'ArrowRight') nextBtn.click();
    });

    // Deep-link z hash: portfolio.html#marka-f => kliknie właściwy kafel
    document.addEventListener('DOMContentLoaded', () => {
      const slug = location.hash ? location.hash.slice(1) : '';
      if (!slug) return;
      const item = document.getElementById(slug);
      if (item) {
        // auto-scroll i auto-open
        setTimeout(() => item.click(), 120);
      }
    });
  </script>
</body>
</html>
